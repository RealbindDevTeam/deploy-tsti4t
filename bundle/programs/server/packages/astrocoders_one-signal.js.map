{"version":3,"sources":["meteor://ðŸ’»app/packages/astrocoders:one-signal/lib/one_signal.js"],"names":["SentNotifications","Mongo","Collection","OneSignal","_base","send","method","api","data","url","apiKey","Meteor","settings","oneSignal","HTTP","call","headers","Authorization","Notifications","_api","create","players","appId","insert","createdAt","Date","app_id","include_player_ids"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,oBAAoB,IAAIC,MAAMC,UAAV,CAAqB,wBAArB,CAApB;AAEAC,YAAY;AACVC,SAAO,+BADG;;AAEVC,OAAKC,MAAL,EAAaC,GAAb,EAAkBC,IAAlB,EAAuB;AACrB,UAAMC,MAAO,GAAE,KAAKL,KAAM,IAAGG,GAAI,EAAjC;AACA,UAAM;AAAEG;AAAF,QAAaC,OAAOC,QAAP,CAAgBC,SAAnC;AAEA,WAAOC,KAAKC,IAAL,CAAUT,MAAV,EAAkBG,GAAlB,EAAuB;AAC5BD,UAD4B;AAE5BQ,eAAS;AACPC,uBAAgB,SAAQP,MAAO;AADxB;AAFmB,KAAvB,CAAP;AAMD;;AAZS,CAAZ;AAeAP,UAAUe,aAAV,GAA0B;AACxBC,QAAM,eADkB;;AAExBC,SAAOC,OAAP,EAAgBb,IAAhB,EAAqB;AACnB,UAAMC,MAAO,GAAE,KAAKU,IAAK,EAAzB;AACA,UAAM;AAAEG;AAAF,QAAYX,OAAOC,QAAP,CAAgBC,SAAlC;AAEAb,sBAAkBuB,MAAlB,4BACKf,IADL;AAEEgB,iBAAW,IAAIC,IAAJ;AAFb;AAKA,WAAOtB,UAAUE,IAAV,CAAe,MAAf,EAAuBI,GAAvB,6BACFD,IADE;AAELkB,cAAQJ,KAFH;AAGLK,0BAAoBN;AAHf,OAAP;AAKD;;AAhBuB,CAA1B,C","file":"/packages/astrocoders_one-signal.js","sourcesContent":["SentNotifications = new Mongo.Collection('oneSignalNotifications');\n\nOneSignal = {\n  _base: 'https://onesignal.com/api/v1/',\n  send(method, api, data){\n    const url = `${this._base}/${api}`;\n    const { apiKey } = Meteor.settings.oneSignal;\n\n    return HTTP.call(method, url, {\n      data,\n      headers: {\n        Authorization: `Basic ${apiKey}`,\n      },\n    });\n  },\n};\n\nOneSignal.Notifications = {\n  _api: 'notifications',\n  create(players, data){\n    const url = `${this._api}`;\n    const { appId } = Meteor.settings.oneSignal;\n\n    SentNotifications.insert({\n      ...data,\n      createdAt: new Date(),\n    });\n\n    return OneSignal.send('POST', url, {\n      ...data,\n      app_id: appId,\n      include_player_ids: players,\n    });\n  },\n};\n"]}